[{"path":"/articles/NAME-OF-VIGNETTE.html","id":"installation-the-package","dir":"Articles","previous_headings":"","what":"Installation the package","title":"Tutorial","text":"begin , user need install packages Load necessary packages Generate data binary outcomes, illustration. label shift parameter set 0.5. use rejection sampling procedure generate external data label shift Calculate variance-covariance matrix parameters reduced model based external data Conduct information integration incorporating summary estimate (theta_ext_est) variance matrix (v_ext) main model Calculate asymptotic standard errors compare, also provide function GIM estimate, lead biased estimates presence label shift. variance-covariance matrix available, apply proposed iterative updating scheme recover matrix v_ext information integration. demos including case continuous outcome uploaded shortly.","code":"if (!require(\"devtools\")) {   install.packages(\"devtools\") } devtools::install_github(\"chencxxy28/sGIM\") library(sGIM) library(mvtnorm) library(rootSolve) library(MASS) library(Matrix) library(sandwich) #basic setups ratio<-3 n<-1000 N<-100000 n_ext<-n*ratio num.iter<-20 num.cov<-4 betaT<-rep(0.5,num.cov+3) gammaT<-0.5 used_index<-c(1:5) sigma.cov<-diag(0.3,num.cov) sigma.cov[,]<-0.3 diag(sigma.cov)<-1  #generalte external data   ##do rejection sampling   num.big<-round(N/(1/exp(0.5)))   z1_all<-rbinom(num.big,1,0.5)   z2_all<-runif(num.big,0,1)   x_raw_all<-rmvnorm(num.big,rep(0,num.cov),sigma.cov)   x1_all<-x_raw_all[,1]+z1_all   x2_all<-x_raw_all[,2]+z2_all   x3_all<-x_raw_all[,3]   x4_all<-x_raw_all[,4]   x_all<-cbind(1,x1_all,x2_all,x3_all,x4_all,z1_all,z2_all)   mu_all<-(1+exp(-x_all%*%betaT))^(-1)   y_all<-rbinom(num.big,1,mu_all)      ##check   eva<-runif(num.big,0,1)   use_index<-ifelse(eva<(exp(gammaT*y_all)/(0.745861*exp(gammaT)+(1-0.745861)))/                       (1.1*exp(gammaT)),1,0)   table(use_index)      ##make external data   ext_used<-sample(1:sum(use_index),n_ext)   y_ext<-y_all[use_index==1][ext_used]   x_ext<-x_all[use_index==1,][ext_used,]   dim(x_ext)            #generate internal data   z1_int<-rbinom(n,1,0.5)   z2_int<-runif(n,0,1)   x_raw_int<-rmvnorm(n,rep(0,num.cov),sigma.cov)   x1_int<-x_raw_int[,1]+z1_int   x2_int<-x_raw_int[,2]+z2_int   x3_int<-x_raw_int[,3]   x4_int<-x_raw_int[,4]   x_int<-cbind(1,x1_int,x2_int,x3_int,x4_int,z1_int,z2_int)   mu_int<-(1+exp(-x_int%*%betaT))^(-1)   y_int<-rbinom(n,1,mu_int)      prop.table(table(y_int))   prop.table(table(y_ext))     ##calculate theta (summary estimates in the reduced model based on the external data)     fit<-glm(y_ext~x_ext[,used_index]-1,family = binomial(link = \"logit\"))   theta_ext<-c(fit$coefficients)      theta_ext_est<-theta_ext_ini<-theta_ext ###estimate theta variance   sandwith_self<-function(y_ext,x_ext,theta_ext,used_index)   {     n<-length(y_ext)     ee_all<-0     dee_all<-0     for(i in 1:n)     {       mu_i<-(1+exp(-x_ext[i,used_index]%*%theta_ext))^(-1)       ee_i<-c(x_ext[i,used_index])*c(y_ext[i]-mu_i)       dee_i<--c(x_ext[i,used_index])%*%t(x_ext[i,used_index])*c(mu_i)*c(1-mu_i)              ee_all<-ee_all+ee_i%*%t(ee_i)/n       dee_all<-dee_all+dee_i/n     }     ginv(dee_all)%*%ee_all%*%ginv(dee_all)/n   }   v_ext<-sandwith_self(y_ext,x_ext,theta_ext,used_index) fit<-glm(y_int~x_int-1,family = binomial(link = \"logit\"))   beta_mle<-c(fit$coefficients)   beta_initial<-beta_mle #use mle as initial values of beta      all_results<-information.borrowing_lgim_binary(beta_initial=beta_initial,gamma_initial=0.5,theta_ext_ini=theta_ext_ini,theta_ext_est=theta_ext_est,v_ext=v_ext, y_int=y_int,x_int=x_int,used_index=used_index) #here gamma can be valued zero as initial, but it may take more time    beta_est<-all_results$beta_est #main parameters in the full model   gamma_est<-all_results$gamma_est #shift parameter   theta_est<-all_results$theta_est #estimated parameters in the reduced model V_asymptotic<-asymptotic_var_general_binary(beta_est=beta_est,gamma_est=gamma_est,theta_est=theta_est,v_ext=v_ext,y_int=y_int,x_int=x_int,used_index=used_index)   V_asymptotic<-V_asymptotic[-c(1:nrow(v_ext)),-c(1:nrow(v_ext))] #the first nrow(v_ext) elements are related to lagrange multiplier   beta_v_iter<-sqrt(diag(V_asymptotic[1:ncol(x_int),1:ncol(x_int)])) #asymptotic standard error for main parameters in the full model   gamma_v_iter<-sqrt((V_asymptotic[ncol(x_int)+1,ncol(x_int)+1]))#asymptotic standard error for the shift parameter   theta_v_iter<-sqrt(diag(V_asymptotic[-c(1:(ncol(x_int)+1)),-c(1:(ncol(x_int)+1))])) #asymptotic standard error for estimated parameters in the reduced model all_results_gim<-information.borrowing_gim(beta_initial=beta_initial,theta_ext_ini=theta_ext_ini,theta_ext_est=theta_ext_est,v_ext=v_ext,y_int=y_int,x_int=x_int,used_index=used_index)  beta_est_gim<-all_results_gim$beta_est"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Chixiang Chen. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chen C (2023). sGIM: Integrating External Summary Information Presence Prior Probability Shift. R package version 0.1.0, https://github.com/chencxxy28/sGIM.","code":"@Manual{,   title = {sGIM: Integrating External Summary Information in the Presence of Prior Probability Shift},   author = {Chixiang Chen},   year = {2023},   note = {R package version 0.1.0},   url = {https://github.com/chencxxy28/sGIM}, }"},{"path":"/index.html","id":"sgim","dir":"","previous_headings":"","what":"Integrating External Summary Information in the Presence of Prior Probability Shift","title":"Integrating External Summary Information in the Presence of Prior Probability Shift","text":"Integrating External Summary Information Presence Prior Probability Shift","code":""},{"path":"/reference/asymptotic_var_general_binary.html","id":null,"dir":"Reference","previous_headings":"","what":"Asymptotic variance based on sGIM for the binary outcome — asymptotic_var_general_binary","title":"Asymptotic variance based on sGIM for the binary outcome — asymptotic_var_general_binary","text":"function calculate asymptotic variance sGIM","code":""},{"path":"/reference/asymptotic_var_general_binary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Asymptotic variance based on sGIM for the binary outcome — asymptotic_var_general_binary","text":"","code":"asymptotic_var_general_binary(beta_est,gamma_est,theta_est, v_ext,y_int,x_int,used_index)"},{"path":"/reference/asymptotic_var_general_binary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Asymptotic variance based on sGIM for the binary outcome — asymptotic_var_general_binary","text":"beta_est estimates main parameter vector gamma_est estimates shift parameter theta_est estimates parameters reduced model v_ext variance-covariance matrix external source y_int outcome vector internal data x_int covariate matrix internal data used_index index parameters reduced model relation full model","code":""},{"path":"/reference/asymptotic_var_general_binary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Asymptotic variance based on sGIM for the binary outcome — asymptotic_var_general_binary","text":"asymptotic variance-covariance matrix","code":""},{"path":"/reference/asymptotic_var_general_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Asymptotic variance based on sGIM for the continuous outcome — asymptotic_var_general_normal","title":"Asymptotic variance based on sGIM for the continuous outcome — asymptotic_var_general_normal","text":"function calculate asymptotic variance sGIM","code":""},{"path":"/reference/asymptotic_var_general_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Asymptotic variance based on sGIM for the continuous outcome — asymptotic_var_general_normal","text":"","code":"asymptotic_var_general_normal(beta_est,gamma_est, sigma2_est,theta_est,v_ext,y_int,x_int,used_index)"},{"path":"/reference/asymptotic_var_general_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Asymptotic variance based on sGIM for the continuous outcome — asymptotic_var_general_normal","text":"beta_est estimates main parameter vector gamma_est estimates shift parameter sigma2_est initial value variance parameter theta_est estimates parameters reduced model v_ext variance-covariance matrix external source y_int outcome vector internal data x_int covariate matrix internal data used_index index parameters reduced model relation full model","code":""},{"path":"/reference/asymptotic_var_general_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Asymptotic variance based on sGIM for the continuous outcome — asymptotic_var_general_normal","text":"asymptotic variance-covariance matrix","code":""},{"path":"/reference/information.borrowing_gim_binary.html","id":null,"dir":"Reference","previous_headings":"","what":"GIM for the binary outcome — information.borrowing_gim_binary","title":"GIM for the binary outcome — information.borrowing_gim_binary","text":"function can integrate summary information external source","code":""},{"path":"/reference/information.borrowing_gim_binary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GIM for the binary outcome — information.borrowing_gim_binary","text":"","code":"information.borrowing_gim_binary(beta_initial,theta_ext_ini, theta_ext_est,v_ext,y_int,x_int,used_index)"},{"path":"/reference/information.borrowing_gim_binary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GIM for the binary outcome — information.borrowing_gim_binary","text":"beta_initial initial values main parameter vector theta_ext_ini initial values parameters reduced model theta_ext_est summary information (parameter estimates) external source v_ext variance-covariance matrix external source y_int outcome vector internal data x_int covariate matrix internal data used_index index parameters reduced model relation full model","code":""},{"path":"/reference/information.borrowing_gim_binary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GIM for the binary outcome — information.borrowing_gim_binary","text":"list parameter estimates","code":""},{"path":"/reference/information.borrowing_gim_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"GIM for the continuous outcome — information.borrowing_gim_normal","title":"GIM for the continuous outcome — information.borrowing_gim_normal","text":"function can integrate summary information external source","code":""},{"path":"/reference/information.borrowing_gim_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GIM for the continuous outcome — information.borrowing_gim_normal","text":"","code":"information.borrowing_gim_normal(beta_initial, theta_ext_ini,theta_ext_est,v_ext,y_int,x_int,used_index)"},{"path":"/reference/information.borrowing_gim_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GIM for the continuous outcome — information.borrowing_gim_normal","text":"beta_initial initial values main parameter vector theta_ext_ini initial values parameters reduced model theta_ext_est summary information (parameter estimates) external source v_ext variance-covariance matrix external source y_int outcome vector internal data x_int covariate matrix internal data used_index index parameters reduced model relation full model","code":""},{"path":"/reference/information.borrowing_gim_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GIM for the continuous outcome — information.borrowing_gim_normal","text":"list parameter estimates","code":""},{"path":"/reference/information.borrowing_lgim_binary.html","id":null,"dir":"Reference","previous_headings":"","what":"sGIM for the binary outcome — information.borrowing_lgim_binary","title":"sGIM for the binary outcome — information.borrowing_lgim_binary","text":"function can integrate summary information external source","code":""},{"path":"/reference/information.borrowing_lgim_binary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sGIM for the binary outcome — information.borrowing_lgim_binary","text":"","code":"information.borrowing_lgim_binary(beta_initial,gamma_initial, theta_ext_ini,theta_ext_est,v_ext,y_int,x_int,used_index)"},{"path":"/reference/information.borrowing_lgim_binary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sGIM for the binary outcome — information.borrowing_lgim_binary","text":"beta_initial initial values main parameter vector gamma_initial initial values shift parameter theta_ext_ini initial values parameters reduced model theta_ext_est summary information (parameter estimates) external source v_ext variance-covariance matrix external source y_int outcome vector internal data x_int covariate matrix internal data used_index index parameters reduced model relation full model","code":""},{"path":"/reference/information.borrowing_lgim_binary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sGIM for the binary outcome — information.borrowing_lgim_binary","text":"list parameter estimates","code":""},{"path":"/reference/information.borrowing_lgim_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"sGIM for the continuous outcome — information.borrowing_lgim_normal","title":"sGIM for the continuous outcome — information.borrowing_lgim_normal","text":"function can integrate summary information external source","code":""},{"path":"/reference/information.borrowing_lgim_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sGIM for the continuous outcome — information.borrowing_lgim_normal","text":"","code":"information.borrowing_lgim_normal(beta_initial, gamma_initial,sigma2_initial,theta_ext_ini,theta_ext_est, v_ext,y_int,x_int,used_index)"},{"path":"/reference/information.borrowing_lgim_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sGIM for the continuous outcome — information.borrowing_lgim_normal","text":"beta_initial initial values main parameter vector gamma_initial initial values shift parameter sigma2_initial initial value variance parameter theta_ext_ini initial values parameters reduced model theta_ext_est summary information (parameter estimates) external source v_ext variance-covariance matrix external source y_int outcome vector internal data x_int covariate matrix internal data used_index index parameters reduced model relation full model","code":""},{"path":"/reference/information.borrowing_lgim_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sGIM for the continuous outcome — information.borrowing_lgim_normal","text":"list parameter estimates","code":""}]
